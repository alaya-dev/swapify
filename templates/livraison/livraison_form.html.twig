<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Créer une Livraison</title>

    <!-- Ajouter OpenLayers -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@latest/ol.css">
<script src="https://cdn.jsdelivr.net/npm/ol@latest/dist/ol.js"></script>


   
</head>
 <style>
        #map {
            width: 100%;
            height: 400px;
        }
    </style>
<body>

<h1>Créer une Livraison</h1>
   
    <form action="{{ path('livraison_create') }}" method="post" novalidate>
<label for="telephone_expediteur">Téléphone :</label>
<input type="text" id="telephone_expediteur" name="telephone_expediteur" value={{app.user.tel}} >

<label for="code_postal_expediteur">Code Postal :</label>
<input type="text" id="code_postal_expediteur" name="code_postal_expediteur" >

<label for="latitude_expediteur">Latitude Expéditeur :</label>
<input type="text" id="latitude_expediteur" name="localisation_expediteur_lat" readonly >

<label for="longitude_expediteur">Longitude Expéditeur :</label>
<input type="text" id="longitude_expediteur" name="localisation_expediteur_lng" readonly >

<label for="email_destinataire">Email du Destinataire :</label>
<input type="email" id="email_destinataire" name="email_destinataire" >

<button type="submit">Créer la Livraison</button>
</form>

<div id="map" style="width: 100%; height: 400px;"></div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    var map = new ol.Map({
        target: 'map',
        layers: [
            new ol.layer.Tile({
                source: new ol.source.OSM()
            })
        ],
        view: new ol.View({
            center: ol.proj.fromLonLat([0, 0]),
            zoom: 2
        })
    });

    navigator.geolocation.getCurrentPosition(function (position) {
        var lat = position.coords.latitude;
        var lng = position.coords.longitude;

        document.getElementById('latitude_expediteur').value = lat;
        document.getElementById('longitude_expediteur').value = lng;

        var marker = new ol.Feature({
            geometry: new ol.geom.Point(ol.proj.fromLonLat([lng, lat]))
        });

        var vectorSource = new ol.source.Vector({
            features: [marker]
        });

        var vectorLayer = new ol.layer.Vector({
            source: vectorSource,
            style: new ol.style.Style({
                image: new ol.style.Icon({
                    anchor: [0.5, 1],
                    src: 'https://upload.wikimedia.org/wikipedia/commons/e/ec/RedDot.svg'
                })
            })
        });

        map.addLayer(vectorLayer);
        map.getView().setCenter(ol.proj.fromLonLat([lng, lat]));
        map.getView().setZoom(15);
    });
});
</script>


</body>
</html>
